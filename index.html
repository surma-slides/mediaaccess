<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Media Access</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/mods.css">
		<link rel="stylesheet" href="css/theme/default.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Media Access</h1>
					<h3>We need more use-cases</h3>
					<h3>for EmScripten</h3>
          <p>
            <small>by <a href="http://twitter.com/surmair" target="_blank">Alexander “Surma” Surma</a>, October 2014</small>
          </p>
					<p>
						<small><a href="http://surma-slides.github.io/mediaaccess">surma-slides.github.io/mediaaccess</a></small>
					</p>
				</section>

				<section>
					<h2>Included you will find…</h2>
					<p>
						Bundle of standards (mostly drafts) about different kinds of access to different kinds of media.
					</p>

					<aside class="notes">
						2 completed standards (+ Ontology), 1 working candidate, 8 drafts.
						Use-cases et al. not included. Media is video, audio, webpages, anything.
					</aside>
				</section>
				<section>
					<section data-state="subtheme-pink">
						<h2>Buzzwords!</h2>
						<p>
							Who has heared of <code>getUserMedia()</code> or <code>Web Audio API</code>?
						</p>
						<aside class="notes">
							Arguably the most hyped and well known standards out of the media access collection.
						</aside>
					</section>
          <section data-state="subtheme-pink">
            <h2>Buzzwords!</h2>
            <iframe width="560" height="315" src="//www.youtube.com/embed/MsAWR_rJ5n8" frameborder="0" allowfullscreen></iframe>
            <p>
              February 3, 2013
            </p>
            <aside class="notes">
            </aside>
          </section>
          <section data-state="subtheme-pink">
            <h2>Buzzwords!</h2>
            <iframe width="560" height="315" src="//www.youtube.com/embed/cqtBpCqgOgM?start=400" frameborder="0" allowfullscreen></iframe>
            <p>
              October 9, 2014
            </p>
            <aside class="notes">
            </aside>
          </section>
					<section data-state="subtheme-pink">
						<h2><code>getUserMedia()</code></h2>
						<p>
							<a class="usermedia demo">Demo</a>
						</p>
						<video class="usermedia demo" width="400" height="300"></video>
						<script>
							document.querySelector('a.usermedia.demo').addEventListener('click', function(){
								navigator.getUserMedia = (navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia);
								if (navigator.getUserMedia) {
									navigator.getUserMedia({
										video: true,
										audio: false
									},
									function(localMediaStream) {
										var video = document.querySelector('video');
										video.src = window.URL.createObjectURL(localMediaStream);
										video.play();
										setTimeout(function() {
											localMediaStream.stop();
											video.src = "";
										}, 5000);
									},
									function(err) {
										console.log("The following error occured: " + err);
									});
								} else {
									console.log("getUserMedia not supported");
								}
							});
						</script>
						<aside class="notes">
              Access to devices, individual frames, etc
						</aside>
					</section>

          <section data-state="subtheme-pink">
            <h2><code>Web Audio API</code></h2>
            <p>
              <a class="audioapi demo">Demo</a>
            </p>
            <script>
                var context = new webkitAudioContext(); // Create audio container
                var oscillator;
                var playing = false;
                function toggle() {
                  if(playing) {
                    oscillator.stop();
                    playing = false;
                  } else {
                    oscillator = context.createOscillator(); // Create sound source
                    oscillator.connect(context.destination); // Connect sound to output
                    oscillator.noteOn(0);
                    playing = true;
                  }
                }
                document.querySelector('.audioapi.demo').addEventListener('click', toggle);
            </script>
            <aside class="notes">
              Access to decoders, generators, input and output devices, etc
            </aside>
          </section>
				</section>
				<section>
					<h2>Media Access?</h2>
					<p>
						<ul>
							<li>access media files (fragments)</li>
							<li>access media metadata</li>
							<li>access A/V devices</li>
							<li>generate and output audio</li>
							<li>process and record audio streams</li>
              <li>accessibility</li>
						</ul>
					</p>
					<aside class="notes">
					</aside>
				</section>
        <section>
          <section data-state="subtheme-green">
            <h2>Media Fragments URI</h2>
            <h4>Quick overview</h4>
            <p>
              Access fragments of media
            </p>
            <aside class="notes">
              “Completed Work”. Tight coupling with a draft “Fragment Resolution”.
              What are fragments? Fragments can be in temporal and spatial dimensions. Also tracks.
            </aside>
          </section>
          <section data-state="subtheme-green">
            <h2>Media Fragments URI</h2>
            <h3>Goal</h3>
            <p>
              <img src="images/mediafragment.jpg">
            </p>
            <aside class="notes">
              Lets start with dimensions.
            </aside>
          </section>
          <section data-state="subtheme-green">
            <h2>Media Fragments URI</h2>
            <h4>Dimensios</h4>
            <ul>
              <li>Spatial</li>
              <li>Temporal</li>
              <li>Tracks</li>
              <li>ID</li>
            </ul>
            <aside class="notes">
              ID is a a convenience layer for temporal dimension
            </aside>
          </section>
          <section data-state="subtheme-green">
            <h2>Media Fragments URI</h2>
            <h3>Temporal Fragmentation</h3>
            <p>
              Syntax:
              <pre><code>
t=&lt;start&gt;,&lt;end&gt;
              </code></pre>
            </p>
            <p>
              Example:
              <pre><code>
t=20,1:24:30
t=npt:50
t=,22:10
              </code></pre>
            </p>
            <aside class="notes">
              npt=Normal Play Time, could also be SMPTE timecodes (Society of Motion Picture & Television Engineering)
            </aside>
          </section>
          <section data-state="subtheme-green">
            <h2>Media Fragments URI</h2>
            <h3>Spatial Fragmentation</h3>
            <p>
              Syntax:
              <pre><code>
xywh=&lt;start&gt;,&lt;end&gt;
              </code></pre>
            </p>
            <p>
              Example:
              <pre><code>
xywh=160,120,320,240
xywh=pixel:160,120,320,240
xywh=percent:25,25,50,50
              </code></pre>
            </p>
            <aside class="notes">
              Both temporal and spatial fragmentation have exact definition how to validate and calculate the fragmented media. Where to apply the syntax? Let's talk about URIs.
            </aside>
          </section>
          <section data-state="subtheme-amber">
            <h2>URI</h2>
            <h3>Intermezzo</h3>
            <p>
              <pre><code>
  foo://example.com:8042/over/there?name=ferret#nose
  \_/   \______________/\_________/ \_________/ \__/
   |           |            |            |        |
scheme     authority       path        query   fragment
              </code></pre>
            </p>
            <aside class="notes">
              <p>
                URI as a abstraction of URLs. URLs by Tim Berners-Lee. URLs specify a location. Supposed to be persistent over time. Changing content via redirection.
              </p>
              <p>
                Fragment technically not part of resource locator (UserAgent handles it, will not be transferred to server).
              </p>
            </aside>
          </section>
          <section data-state="subtheme-green">
            <h2>Media Fragments URI</h2>
            <h3>Usage</h3>
            <p>
              Individual resource (server-side implementation)
              <pre><code>
http://yt.com/FL3MqSKLNHY<em>?t=20,30&xywh=160,120,320,240</em>
              </code></pre>
              Modifier on a resource (client-side implementation)
              <pre><code>
http://yt.com/FL3MqSKLNHY<em>#t=20,30&xywh=160,120,320,240</em>
              </code></pre>
            </p>
            <aside class="notes">
              Semantics! Technically no relation between fragmented version and original verison with server-side implementation.
              Standard defines how to validate and calculate fragment descriptions.
              How is server side implemented? How is client side implemented?
            </aside>
          </section>
          <section data-state="subtheme-green">
            <h2>Media Fragments URI</h2>
            <h3>Resolution</h3>
            <img src="images/mediafragmentresolution.png">
            <aside class="notes">
              When cached: easy. When not cached: Range request. Can the UA solve fragment2byte-range problem?
              When not: Special header or query.
            </aside>
          </section>
          <section data-state="subtheme-green">
            <h2>Media Fragments URI</h2>
            <h3>Augmented HTTP Range Header</h3>
            <pre><code data-hint="Request">
GET /video.ogv HTTP/1.1
Host: www.example.com
Accept: video/*
<em>Range: t:npt=10-20</em>
            </code></pre>
            <pre><code data-hint="Response">
HTTP/1.1 206 Partial Content
Accept-Ranges: bytes, t, id
Content-Length: 3743
Content-Type: video/ogg
<em>Content-Range: bytes 19147-22880/35614993
Content-Range-Mapping: { t:npt 9.85-21.16/0.0-653.79 }
  = { bytes 19147-22880/35614993 }</em>
Etag: "b7a60-21f7111-46f3219476580"

{binary data}
            </code></pre>
            <aside class="notes">
              What if client doesn’t have headers (resolution, color space, etc?)
            </aside>
          </section>
         <section data-state="subtheme-green">
            <h2>Media Fragments URI</h2>
            <h3>Augmented HTTP Range Header</h3>
            <pre><code data-hint="Request">
GET /video.ogv HTTP/1.1
Host: www.example.com
Accept: video/*
Range: t:npt=10-20<em>;include-setup</em>
            </code></pre>
            <pre><code data-hint="Response">
HTTP/1.1 206 Partial Content
Accept-Ranges: bytes, t
Content-Length: 804020
<em>Content-Type: multipart/byteranges;boundary=End
Content-Range-Mapping:
  { t:npt 10.0-20.0/0-38.3;include-setup } =
  { bytes 0-1650,1264525-2066894/4055466 0}</em>
  --End
Content-Type: video/webm
Content-Range: bytes 0-1650/4055466
{binary data}
--End
Content-Type: video/webm
Content-Range: bytes 1264525-2066894/4055466
{binary data}
            </code></pre>
            <aside class="notes">

            </aside>
          </section>
          <section data-state="subtheme-green">
            <h2>Media Fragments URI</h2>
            <h3>Support</h3>
            <figure>
              <img src="images/mediafragmentsupport.png">
              <figcaption>
                <a href="http://caniuse.com/#search=fragments">caniuse.com/#search=fragments</a>
              </figcaption>
            </figure>
            <aside class="notes">
              Non-existent. caniuse.com by no means authorative, in this case symbolic.
            </aside>
          </section>
        </section>
          <section data-state="subtheme-pink">
            <h2><code>getUserMedia()</code></h2>
            <p>
              <pre><code data-trim>
navigator.getUserMedia = (
  navigator.getUserMedia ||
  navigator.webkitGetUserMedia ||
  navigator.mozGetUserMedia ||
  navigator.msGetUserMedia
);
              </code></pre>
            </p>
            <aside class="notes">
              The usual cross-browser trickery
            </aside>
          </section>
          <section data-state="subtheme-pink">
            <h2><code>getUserMedia()</code></h2>
            <p>
              <pre><code data-trim>
navigator.getUserMedia({
  video: true,
  audio: false
},
function(localMediaStream) {
  var video = document.querySelector('video');
  video.src = window.URL.createObjectURL(localMediaStream);
  video.play();
  setTimeout(function() {
    localMediaStream.stop();
    video.src = "";
  }, 5000);
},
function(err) {
  console.log("The following error occured: " + err);
});
              </code></pre>
            </p>
            <aside class="notes">
              1st parameter: Constraing object, 2nd/3rd: success/fail callback
            </aside>
          </section>
          <section data-state="subtheme-pink">
            <h2><code>Web Audio API</code></h2>
            <p>
              <pre><code data-trim>
var context = new webkitAudioContext();
var oscillator = context.createOscillator();
oscillator.connect(context.destination);
oscillator.noteOn(0);
              </code></pre>
            </p>
            <aside class="notes">
            </aside>
          </section>
          <section>
            <h1>Sources</h1>
            <ul>
              <li>http://www.w3.org/TR/2012/REC-media-frags-20120925/</li>
              <li>http://www.w3.org/TR/2011/WD-media-frags-recipes-20111201/</li>
              <li>http://ninsuna.elis.ugent.be/MediaFragmentsServer</li>
            </ul>
          </section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>
			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: 'material-design', // available themes are in /css/theme
				transition: 'linear', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					// { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

			var baseTheme = Reveal.getConfig().theme;
			Reveal.addEventListener('slidechanged', function() {
				var c = document.documentElement.className;
				if(c.substr(0, 9) == 'subtheme-') {
					Reveal.configure({
						theme: baseTheme+'-'+c.substr(9)
					});
				} else {
					Reveal.configure({
						theme: baseTheme
					});
				}
			}, false );

		</script>

	</body>
</html>
